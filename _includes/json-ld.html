<script type="application/ld+json">
{
  "@context": "https://schema.org",
  {%- if page.layout == 'members' -%}
    
    {%- if page.type == 'organisatie' -%}
    "@type": "Organization",
    {%- else -%}
    "@type": "Person",
    "jobTitle": "{{ page.label | default: page.work.position }}",
    {%- endif -%}

    "@id": "{{ page.url | absolute_url }}",
    "url": "{{ page.url | absolute_url }}",
    "name": "{{ page.title }}",
    "description": "{{ page.content | strip_html | truncatewords: 20 | escape | strip_newlines }}",
    
    {%- if page.image -%}
    "image": "{{ page.image | absolute_url }}",
    {%- endif -%}

    {%- comment -%} --- SAME AS (Website + Wikidata + Socials) --- {%- endcomment -%}
    "sameAs": [
        {%- assign same_as_links = "" | split: "," -%}
        
        {%- if page.website -%}
            {%- assign same_as_links = same_as_links | push: page.website -%}
        {%- endif -%}
        
        {%- if page.wikidata -%}
            {%- capture wiki_url -%}https://www.wikidata.org/wiki/{{ page.wikidata }}{%- endcapture -%}
            {%- assign same_as_links = same_as_links | push: wiki_url -%}
        {%- endif -%}
        
        {%- if page.social -%}
            {%- for social_url in page.social -%}
                {%- assign same_as_links = same_as_links | push: social_url -%}
            {%- endfor -%}
        {%- endif -%}

        {%- for link in same_as_links -%}
            "{{ link }}"{%- unless forloop.last -%},{%- endunless -%}
        {%- endfor -%}
    ],

    {%- comment -%} --- WORKS FOR (Employment) --- {%- endcomment -%}
    {%- if page.type == 'persoon' and page.work.company -%}
    "worksFor": {
        "@type": "Organization",
        "name": "{{ page.work.company }}"
        {%- if page.work.website -%},
        "sameAs": "{{ page.work.website }}"
        {%- endif -%}
    },
    {%- endif -%}

    {%- comment -%} --- MEMBER OF (Open NL + Affiliaties + Organisaties) --- {%- endcomment -%}
    "memberOf": [
        {
            "@type": "Organization",
            "name": "Vereniging Open Nederland",
            "@id": "{{ '/' | absolute_url }}"
            {%- if page.bestuursfunctie -%},
            "description": "Bestuursfunctie: {{ page.bestuursfunctie }}"
            {%- endif -%}
        }
        {%- if page.organisaties -%}
            {%- for org in page.organisaties -%}
            ,{
                "@type": "Organization",
                "name": "{{ org }}"
            }
            {%- endfor -%}
        {%- endif -%}
        {%- if page.affiliations -%}
            {%- for aff in page.affiliations -%}
            ,{
                "@type": "Organization",
                "name": "{{ aff }}"
            }
            {%- endfor -%}
        {%- endif -%}
    ],
    
    "knowsAbout": [
        {%- for tag in page.tags -%}
        "{{ tag }}"{%- unless forloop.last -%},{%- endunless -%}
        {%- endfor -%}
    ]

  {%- elsif page.layout == 'initiatives' -%}
    "@type": "CreativeWork",
    "name": "{{ page.title }}",
    "datePublished": "{{ page.year }}",
    "keywords": "{{ page.tags | join: ', ' }}",
    "url": "{{ page.url | absolute_url }}",
    
    {%- if page.website or page.wikidata -%}
    "sameAs": [
        {%- if page.website -%}
            "{{ page.website }}"{%- if page.wikidata -%},{%- endif -%}
        {%- endif -%}
        {%- if page.wikidata -%}
            "https://www.wikidata.org/wiki/{{ page.wikidata }}"
        {%- endif -%}
    ]
    {%- endif -%}

  {%- else -%}
    "@type": "Organization",
    "@id": "{{ '/' | absolute_url }}",
    "name": "Vereniging Open Nederland",
    "url": "{{ '/' | absolute_url }}",
    "logo": "{{ '/assets/img/logo.png' | absolute_url }}",
    "description": "{{ site.description }}",
    "sameAs": [
        "https://twitter.com/opennederland",
        "https://www.wikidata.org/wiki/Q108331393" 
    ]
  {%- endif -%}
}
</script>